<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link th:href="@{/detailForm.css}" rel="stylesheet">
    <title>자유게시판</title>
</head>

<body>
    <!-- Header -->
    <header class="header"></header>

    <!-- Main Content -->
    <main class="main">
        <div class="main-content">
            <h2 class="title">자유게시판</h2>
            <div class="notice">공지</div>
            <div class="content-title">
                <input th:value="${detailForm.title}" class="content-title-input" type="text">
            </div>
            <div class="content">
                <form class="form">
                    <div class="form-info">
                        <div class="form-info-item info-boardId">
                            <div class="items-label" >순번</div>
                            <input  id="boardId" th:value="${detailForm.boardId}" class="items" type="text" readonly>
                        </div>
                        <div class="form-info-item info-writer">
                            <div class="items-label">작성자</div>
                            <input th:value="${detailForm.writer}" class="items" type="text" readonly>
                        </div>
                        <div class="form-info-item info-created">
                            <div class="items-label">작성일</div>
                            <input th:if="${detailForm.createdAt == null}"
                                   value="생성일 없음"  class="items" type="text" readonly>
                        </div>
                        <div class="form-info-item info-updated">
                            <div class="items-label">수정일</div>
                            <input th:if="${detailForm.updatedAt == null}"
                                   value="수정일 없음"  class="items" type="text" readonly>
                        </div>
                    </div>
                    <div class="form-body">
                        <textarea th:text="${detailForm.content}" class="form-body-input" readonly></textarea>
                    </div>
                    <div class="button-group">
                        <button class="bnt bnt-update">수정</button>
                        <button class="bnt bnt-delete" type="button" id="btnDelete">삭제</button>
                        <button class="bnt bnt-list" type="button" id="btnFindAll">목록</button>
                    </div>
                </form>
            </div>
            <div class = "reply">
                댓글창
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer"></footer>

    <dialog id="modalDel">
        <p>삭제하시겠습니까?</p>
        <button class="btnYes">예</button>
        <button class="btnNo">아니오</button>
    </dialog>


    <script>
        //삭제
        const $btnDelete = document.getElementById('btnDelete');
        $btnDelete.addEventListener('click', e=> {
            const $boardId = document.getElementById('boardId');
            const id = $boardId.value;

            const $modalDel = document.getElementById("modalDel")
            const $btnYes = document.querySelector(".btnYes")
            const $btnNo = document.querySelector(".btnNo")

            //모달창 띄우기
            $modalDel.showModal();

            // 모달창 닫힐 때
            $modalDel.addEventListener('close', e=>{
                console.log($modalDel.returnValue);
                if($modalDel.returnValue == "yes") {
                    location.href = `/boards/${id}/del`;
                }
            });

            // 예 버튼 클릭 시
            $btnYes.addEventListener('click', e=> {
                $modalDel.close('yes'); //yes값을 반환하며 모달창을 닫음
            })

            // 아니오 버튼 클릭 시
            $btnNo.addEventListener('click', e=>{
                $modalDel.close("no");
            })

        }, false)

        //목록
        const $btnFindAll = document.getElementById('btnFindAll');
        $btnFindAll.addEventListener('click', e => {
            location.href = '/boards'  //get http://localhost:9090/boards
        }, false)



    </script>

</body>

</html>